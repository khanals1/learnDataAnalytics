import pandas as pd
from sklearn.decomposition import PCA


def import_data():
    df = pd.read_csv("Nichols & Nicki (2004).dat", sep="\t", index_col=0, header=None)
    df = df.reset_index()
    df.columns = df.iloc[0]
    df = df[1:].astype(str).astype(int)
    calculateCorrelationMatrix(df)


def calculateCorrelationMatrix(df):
    correlation_matrix = df[1:].corr().round(2)
    print("###### Correlation Matrix #######")
    print(correlation_matrix)
    correlation_mean = correlation_matrix.mean()
    print("###### Correlation Matrix Mean #######")
    drop_column = correlation_mean.where(correlation_mean < 0.3).dropna().round(2).to_string(header=False)
    print(drop_column)
    df = df.drop(columns=['ias2', 'ias4', 'ias16', 'ias13', 'ias22', 'ias23', 'ias27', 'ias31', 'ias32', 'ias35'])
    var_matrix = df.var()
    print("###### Variation Matrix Mean #######")
    print(var_matrix.where(var_matrix < 0.2).dropna().round(2).to_string(header=False))
    df = df.drop(columns=['ias34'])
    pca = PCA(0.9)
    pca.fit(df)
    print(df)
    print("######################### PCA Components ##############################")
    print("###### Eigen Variance #######")
    print(pca.components_)
    print("###### Eigen Values #######")
    print(pca.explained_variance_)


if __name__ == '__main__':
    import_data()

"""
###### Correlation Matrix #######
0      ias1  ias2  ias3  ias4  ias5  ...  ias32  ias33  ias34  ias35  ias36
0                                    ...                                   
ias1   1.00  0.43  0.46  0.35  0.52  ...   0.22   0.50   0.44   0.38   0.49
ias2   0.43  1.00  0.33  0.54  0.38  ...   0.15   0.36   0.20   0.26   0.32
ias3   0.46  0.33  1.00  0.52  0.47  ...   0.26   0.45   0.29   0.42   0.46
ias4   0.35  0.54  0.52  1.00  0.46  ...   0.17   0.47   0.22   0.25   0.35
ias5   0.52  0.38  0.47  0.46  1.00  ...   0.25   0.60   0.42   0.42   0.47
ias6   0.56  0.24  0.41  0.27  0.48  ...   0.36   0.35   0.47   0.26   0.51
ias7   0.48  0.39  0.48  0.45  0.43  ...   0.14   0.50   0.43   0.25   0.66
ias8   0.48  0.32  0.62  0.44  0.59  ...   0.23   0.49   0.41   0.47   0.56
ias9   0.51  0.29  0.50  0.37  0.51  ...   0.13   0.53   0.37   0.25   0.55
ias10  0.43  0.29  0.40  0.37  0.52  ...   0.27   0.47   0.52   0.27   0.64
ias11  0.42  0.26  0.43  0.26  0.33  ...   0.18   0.44   0.34   0.31   0.49
ias12  0.43  0.32  0.46  0.44  0.44  ...   0.21   0.46   0.37   0.25   0.56
ias13  0.12  0.37  0.19  0.30  0.24  ...   0.26   0.23   0.10   0.15   0.20
ias14  0.49  0.38  0.40  0.36  0.40  ...   0.30   0.43   0.42   0.45   0.54
ias15  0.51  0.35  0.42  0.26  0.37  ...   0.22   0.47   0.48   0.43   0.57
ias16  0.51  0.30  0.40  0.31  0.36  ...   0.27   0.35   0.37   0.35   0.39
ias17  0.35  0.25  0.38  0.29  0.40  ...   0.26   0.36   0.39   0.26   0.58
ias18  0.47  0.28  0.36  0.34  0.47  ...   0.13   0.55   0.54   0.35   0.65
ias19  0.46  0.28  0.65  0.43  0.51  ...   0.24   0.44   0.39   0.46   0.57
ias20  0.48  0.29  0.44  0.42  0.47  ...   0.30   0.62   0.52   0.45   0.69
ias21  0.47  0.29  0.45  0.36  0.52  ...   0.26   0.54   0.41   0.24   0.59
ias22  0.16  0.14  0.18  0.14  0.15  ...   0.33   0.15   0.20   0.26   0.27
ias23  0.28  0.19  0.26  0.25  0.34  ...   0.24   0.29   0.32   0.48   0.47
ias24  0.41  0.31  0.60  0.40  0.49  ...   0.21   0.46   0.27   0.42   0.49
ias25  0.45  0.26  0.35  0.37  0.47  ...   0.21   0.53   0.41   0.48   0.51
ias26  0.52  0.28  0.44  0.27  0.43  ...   0.28   0.49   0.63   0.52   0.64
ias27  0.40  0.29  0.40  0.27  0.35  ...   0.15   0.38   0.28   0.41   0.35
ias28  0.49  0.19  0.37  0.22  0.38  ...   0.30   0.41   0.56   0.45   0.65
ias29  0.54  0.32  0.40  0.42  0.55  ...   0.25   0.68   0.59   0.38   0.64
ias30  0.47  0.30  0.42  0.39  0.47  ...   0.32   0.43   0.30   0.31   0.49
ias31  0.32  0.24  0.51  0.27  0.33  ...   0.20   0.33   0.11   0.32   0.35
ias32  0.22  0.15  0.26  0.17  0.25  ...   1.00   0.26   0.25   0.26   0.19
ias33  0.50  0.36  0.45  0.47  0.60  ...   0.26   1.00   0.47   0.36   0.52
ias34  0.44  0.20  0.29  0.22  0.42  ...   0.25   0.47   1.00   0.49   0.58
ias35  0.38  0.26  0.42  0.25  0.42  ...   0.26   0.36   0.49   1.00   0.43
ias36  0.49  0.32  0.46  0.35  0.47  ...   0.19   0.52   0.58   0.43   1.00

[36 rows x 36 columns]
###### Correlation Matrix Mean #######
ias2     0.32
ias4     0.36
ias13    0.22
ias16    0.36
ias22    0.25
ias23    0.34
ias27    0.35
ias31    0.32
ias32    0.26
ias35    0.37
###### Variation Matrix Mean #######
ias34    0.12
0    ias1  ias3  ias5  ias6  ias7  ...  ias28  ias29  ias30  ias33  ias36
1       1     2     1     1     1  ...      1      1      1      1      1
2       2     3     2     1     1  ...      1      1      1      2      1
3       4     4     3     3     4  ...      2      2      3      2      3
4       1     3     1     1     1  ...      1      1      1      1      1
5       2     3     1     1     1  ...      1      1      1      1      1
..    ...   ...   ...   ...   ...  ...    ...    ...    ...    ...    ...
203     1     3     2     1     1  ...      1      1      3      1      1
204     1     4     1     1     1  ...      1      1      1      1      1
205     3     4     2     3     2  ...      2      1      4      2      1
206     3     5     1     3     4  ...      3      1      1      1      1
207     1     1     2     1     3  ...      3      2      2      1      3

[207 rows x 25 columns]
######################### PCA Components ##############################
###### Eigen Variance #######
[[ 1.99248522e-01  2.73738674e-01  2.12053974e-01  1.31276135e-01
   2.00443892e-01  3.15766670e-01  2.57723972e-01  1.78962412e-01
   1.77279765e-01  2.25457250e-01  1.43919078e-01  1.16590742e-01
   1.57381719e-01  1.70187188e-01  2.59480218e-01  1.72939529e-01
   2.66663666e-01  2.53999319e-01  1.58197734e-01  1.46964041e-01
   1.39202371e-01  1.45339480e-01  1.83503410e-01  1.86392925e-01
   1.61643361e-01]
 [ 6.70233313e-02 -6.00290357e-01 -5.58170305e-02  9.39993610e-02
   1.49332689e-01 -3.85387072e-01  4.17897685e-02  2.10771031e-01
   1.02483588e-01  1.59942256e-01  9.42125173e-02  6.40231425e-02
   1.76347377e-01  2.24358009e-01 -2.93900814e-01  1.54911784e-01
   1.82913876e-01 -2.13961209e-01  5.78863044e-02  1.12936430e-01
   1.26308580e-01  1.56766677e-01 -2.30907912e-04  1.04689215e-01
   1.36059418e-01]
 [ 3.91719956e-02 -1.31619331e-01  2.79278828e-01 -2.29809320e-02
   5.86576837e-02  4.85438580e-01  4.42487295e-01  4.11847749e-02
  -2.82450279e-01 -4.67086780e-02 -1.16431183e-01 -1.23536455e-01
  -5.06050607e-02  2.19109887e-02 -2.80488208e-01 -4.52361012e-02
   1.04679801e-01 -3.69292960e-01 -3.85592098e-02 -1.77277660e-01
  -1.18957130e-01  8.44517018e-04 -2.38993923e-01  1.37685500e-01
  -3.19391860e-02]
 [ 3.88146653e-01 -1.34140387e-01  3.53692984e-01 -6.76133188e-03
  -2.47547368e-01 -4.66165323e-02 -1.38428049e-01 -1.80356532e-01
  -1.29080767e-01 -3.83345577e-01  1.33518092e-01  1.15225031e-01
  -2.42266880e-01  6.37449961e-02  1.22564603e-03  9.45836619e-02
  -2.51883574e-01 -3.69689916e-02  2.84699377e-01  6.13202968e-02
   6.45632552e-02  1.58163464e-01  2.44703989e-01  2.92122928e-01
  -2.47141281e-02]
 [ 1.04706617e-01 -1.19756264e-02 -2.47458215e-01  1.21285038e-01
  -2.19448929e-01  3.11502486e-01 -6.49215332e-02  2.17908706e-02
   2.10003792e-01  1.09290584e-02  9.57130448e-02  2.46148673e-01
   2.63860218e-03 -2.45268529e-03  2.24076357e-01  7.79693248e-02
  -2.37308093e-01 -4.59459563e-01  5.38055817e-02  2.50826837e-01
   3.02258201e-01 -2.90950783e-02 -3.62345365e-01 -1.59600290e-01
   1.02918790e-01]
 [ 4.19168078e-01  4.93036329e-01 -2.23624032e-02  1.76767752e-01
   3.68302146e-01 -3.58231662e-01  7.37599851e-02  1.01329684e-01
  -1.18895745e-01 -8.19405507e-03  9.55295132e-02  3.75163633e-02
   3.05950984e-02 -8.95947050e-03 -1.50218319e-01 -3.80834812e-02
  -2.69643152e-01 -2.50002291e-01 -2.50262361e-01 -4.14090125e-05
  -8.46036858e-02  2.81195166e-02 -1.04518456e-01  4.53804227e-02
   3.52279676e-02]
 [-1.81642526e-01 -2.72518689e-03  2.64194287e-01  5.87888256e-04
   1.86059185e-01  1.18154646e-01 -5.53243077e-01  1.54106858e-01
  -2.60923931e-01  4.15767932e-01 -1.15444339e-01 -1.55647102e-01
   1.16834978e-01  4.03245854e-02  1.56849653e-01  1.01478386e-01
  -2.69171667e-01 -1.95390704e-01  1.89940881e-01 -3.05866157e-02
  -1.44733745e-01  8.81025265e-02 -3.88373511e-03  8.74227648e-02
   7.81578934e-02]
 [-2.53171057e-01  1.94437899e-01 -1.41030502e-01 -2.98250923e-01
   1.28183267e-01 -4.15869492e-02  1.19972168e-02 -3.06510625e-02
   2.04481046e-01 -1.17057450e-01 -5.08685003e-02  6.03359132e-02
  -1.10575011e-01  2.19167261e-01 -2.22804404e-01  2.18234451e-01
  -1.87244278e-01  2.22166428e-01  2.46604193e-01 -7.86661500e-02
   8.69766960e-03  1.43926960e-01 -4.82828396e-01  3.77320317e-01
   5.50840683e-02]
 [-4.17546481e-02 -1.12834145e-01 -4.13864785e-01 -6.03445372e-02
   2.48666540e-01  2.05849616e-01  2.15447866e-01 -9.15676148e-02
  -3.48517026e-01 -8.82241686e-02  1.60217063e-01 -2.46340244e-02
   1.05360881e-01  1.98457485e-01 -7.19390241e-02  1.46349612e-01
  -3.89506921e-01  1.20970909e-01  1.82700148e-01 -5.40890553e-02
   1.99754768e-02 -7.03208827e-02  3.26150091e-01 -2.53614514e-01
   2.00727305e-01]
 [-4.95584367e-01  7.72134573e-02  2.82072027e-01  4.87610549e-02
  -2.52854799e-01 -2.22319325e-01  2.41893269e-01  2.29102211e-01
  -2.04518946e-01 -2.85490505e-01  2.05215979e-01  6.79754934e-02
   2.78560854e-01  1.14784240e-01  2.44671172e-01  1.06780400e-01
  -1.53737261e-01 -5.11914867e-02 -2.38375628e-01  8.08187343e-02
   1.84966666e-03  7.95600885e-02 -3.46956685e-02  1.60216117e-02
   1.12345925e-01]
 [ 1.29061839e-01 -1.96723741e-01  3.05541376e-01  1.98901445e-01
  -5.42818607e-02  7.72954946e-02  8.58390545e-02  2.39615261e-01
   2.51224162e-01  9.00985645e-02  1.24854961e-01 -8.21502530e-02
   1.50734149e-01 -1.27108640e-01 -2.19237553e-01 -1.84846924e-01
  -4.58087656e-01  4.15601296e-01  7.43023565e-02 -4.76665319e-02
  -8.97922422e-03 -4.12153414e-02 -2.21244495e-01 -2.59593151e-01
  -1.21910579e-01]
 [ 7.36057886e-02 -2.14775830e-01  6.34514779e-02  1.41526503e-01
   3.30008278e-01 -2.14442851e-01  1.72849252e-01  6.64557704e-02
  -1.41315853e-01 -1.94411198e-01 -4.41637894e-01  6.65376871e-04
  -2.22441545e-01  6.56939550e-02  5.13244371e-01 -1.29199302e-01
   1.01059530e-03  1.08934610e-01  2.00662972e-01 -3.28733454e-03
   8.59248699e-02 -5.58942585e-02 -2.57907667e-01 -1.24352847e-01
   6.21551880e-02]
 [-6.90068725e-03 -8.97144796e-02  1.06990336e-01  1.09862869e-02
   2.71997208e-01  1.96541779e-01 -3.89852290e-01  1.60735222e-01
  -1.45624783e-01 -2.69850632e-01  3.97576756e-01  2.18763765e-02
  -3.28130474e-01  4.55813593e-02 -7.49519532e-02  7.79123211e-02
   2.44797166e-01  1.85105185e-01 -3.08605391e-01 -2.50831278e-03
   1.11054795e-01 -4.99589599e-02 -2.00684242e-01 -1.77459827e-01
   1.99671537e-01]
 [ 1.61147660e-01 -1.02987074e-01 -2.00609274e-01 -2.78168863e-02
  -2.47607838e-01 -1.31615983e-01  1.82052994e-01 -2.93043935e-02
  -4.01040767e-01  4.16812040e-01  3.30821855e-01 -1.21786854e-01
  -2.13080826e-01 -1.91316780e-01  2.20624092e-01  1.80436366e-01
   2.18797713e-02  1.98394032e-01 -3.47942851e-02 -3.02184141e-02
  -3.33683828e-02  1.76550652e-01 -2.83944925e-01  1.12306031e-01
  -1.42162568e-01]]
  
###### Eigen Values #######
[7.93156088 0.9368543  0.64370395 0.61265039 0.5067347  0.48984229
 0.45210244 0.42292824 0.35926345 0.32279908 0.31904487 0.29453714
 0.25153705 0.24621976]
"""
